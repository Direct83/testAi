# process_data

Утилита командной строки для вычисления среднего значения по указанной колонке из CSV или XLSX файла.

Возможности:
- Поддержка форматов .csv и .xlsx (для .xlsx используется openpyxl).
- Нормализация заголовков столбцов (обрезаются пробелы по краям).
- Конвертация значений колонки в числа: замена десятичной запятой на точку и игнорирование некорректных значений.
- Четко определенные коды выхода.

Коды выхода:
- 0 — успешное выполнение.
- 1 — некорректные аргументы или данные (включая неподдерживаемый формат файла, отсутствие числовых значений и пр.).
- 2 — указанная колонка не найдена.
- 3 — файл не найден.

Требования
- Python 3.11+
- pandas
- openpyxl
- pytest (для запуска тестов)

Установка зависимостей
1. Создайте и активируйте виртуальное окружение (рекомендуется).
2. Установите зависимости:
   pip install -r requirements.txt

Запуск
Примеры:
- CSV:
  python process_data.py --input data.csv --column Price
- XLSX:
  python process_data.py --input data.xlsx --column Price

Вывод — только число со средним значением, форматированным до 3 знаков после запятой.

Примеры вывода:
- 20.000
- 1.235

Обработка распространенных ситуаций
- Файл не найден: код выхода 3 и сообщение об ошибке в stderr.
- Неподдерживаемое расширение: код 1 и сообщение «Неподдерживаемый формат файла».
- Указанная колонка отсутствует: код 2 и сообщение вида «Колонка "<name>" не найдена.»
- Колонка без числовых значений: код 1 и сообщение «нет числовых значений».

Тесты
Для запуска тестов:
- pytest -q

Тесты используют временные файлы и subprocess для проверки CLI-поведения, stdout/stderr и кодов выхода.
